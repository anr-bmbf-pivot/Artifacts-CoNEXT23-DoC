From 89ba4272bc0e9f344252407d05599543d3de183d Mon Sep 17 00:00:00 2001
From: Martine Lenders <m.lenders@fu-berlin.de>
Date: Fri, 10 Dec 2021 14:41:30 +0100
Subject: [PATCH] gcoap_forward_proxy: add output on cache hits

---
 sys/net/application_layer/gcoap/forward_proxy.c | 3 +++
 1 file changed, 3 insertions(+)

diff --git a/sys/net/application_layer/gcoap/forward_proxy.c b/sys/net/application_layer/gcoap/forward_proxy.c
index b145226793..3c9b1b30f5 100644
--- a/sys/net/application_layer/gcoap/forward_proxy.c
+++ b/sys/net/application_layer/gcoap/forward_proxy.c
@@ -80,6 +80,8 @@ static int _cache_build_response(nanocoap_cache_entry_t *ce,
     return header_len_req + opt_payload_len;
 }
 
+extern int ts_printf(const char *format, ...);
+
 static int _cache_lookup_and_process(coap_pkt_t *pdu,
                                      uint8_t *buf,
                                      size_t len,
@@ -96,6 +98,7 @@ static int _cache_lookup_and_process(coap_pkt_t *pdu,
     if (ce &&
         (ce->request_method == coap_get_code(pdu)) &&
         (ce->max_age > now)) {
+        ts_printf("c;%u\n", pdu->hdr->id);
         /* use response from cache */
         return _cache_build_response(ce, pdu, buf, len);
     }
-- 
2.34.1

